{# ========================================================================== #}
{# :: Variables #}
{# ========================================================================== #}
{% set id = data.commonId ?? "" %}
{% set title = data.commonTitle ?? "" %}
{% set description = data.commonDescription ?? "" %}
{% set features = data.commonFeatures.all() ?? [] %}

{# ========================================================================== #}
{# :: Component #}
{# ========================================================================== #}
<section x-data="{ visible: false }" x-intersect.once="visible = true" class="bg-primary py-16 md:py-32" id="{{id}}">
    <div class="container mx-auto px-4 lg:px-8">
        {% if title or description %}
            <div class="text-center mb-16 max-w-3xl mx-auto"
                style="opacity: 0; transform: translateY(24px);"
                :style="`opacity: ${visible ? 1 : 0}; transform: translateY(${visible ? 0 : 24}px); transition: opacity 0.7s ease-out, transform 0.7s ease-out;`">
                {% if title %}
                    <h2 class="text-white mb-6">{{ title|striptags|raw }}</h2>
                {% endif %}
                {% if description %}
                    <h5 class="text-white">{{ description|striptags }}</h5>
                {% endif %}
            </div>
        {% endif %}

        {% if features|length %}
            <div x-data="{ active: 0 }" class="flex flex-col md:flex-row items-center"
                style="opacity: 0; transform: translateY(24px);"
                :style="`opacity: ${visible ? 1 : 0}; transform: translateY(${visible ? 0 : 24}px); transition: opacity 0.7s 150ms ease-out, transform 0.7s 150ms ease-out;`">
                {# Left side: clickable features #}
                <div class="w-full md:w-1/2">
                    <div class="border-t border-white/40">
                        {% for feature in features %}
                            <div
                                @click="active = {{ loop.index0 }}"
                                class="cursor-pointer p-6  py-12 transition-all border-b border-white/40"
                                :class="active === {{ loop.index0 }} ? 'bg-white/10' : 'hover:bg-white/5'"
                            >
                                <div class="flex items-center gap-3">
                                    <h3 class="text-white">{{ feature.commonTitle|striptags }}</h3>
                                </div>

                                <div x-show="active === {{ loop.index0 }}">
                                    {% if feature.commonDescription ?? null %}
                                        <p class="text-white mt-6">{{ feature.commonDescription|striptags }}</p>
                                    {% endif %}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>

                {# Right side: feature image #}
                <div class="w-full md:w-1/2 bg-peach-light rounded p-16">
                    {% for feature in features %}
                        {% set image = feature.commonAsset.one() ?? null %}
                        {% if image %}
                            <div x-show="active === {{ loop.index0 }}" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
                                {% include 'components/image' with {
                                    asset: image,
                                    alt: feature.commonTitle|striptags,
                                    sizes: '(max-width: 768px) 100vw, 50vw',
                                    class: 'w-full rounded',
                                    lazy: false,
                                    widths: [400, 800, 1200],
                                } %}
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    </div>
</section>
